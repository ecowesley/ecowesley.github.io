<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPAs-病人給藥</title>
    <style>
        body { font-family: "Microsoft JhengHei", Arial, sans-serif; margin: 0; padding: 20px; line-height: 1.6; }
        
        /* 頁籤樣式 */
        .tab-container { display: flex; background-color: #f1f1f1; border-bottom: 1px solid #ccc; margin-bottom: 20px; }
        .tab { padding: 10px 20px; cursor: pointer; background-color: #f1f1f1; border: none; outline: none; transition: 0.3s; font-size: 16px; }
        .tab:hover { background-color: #ddd; }
        /* 讓選中的頁籤反綠 */
        .tab.active {
            background-color: #04AA6D; 
            color: white;             
            font-weight: bold;
            border: none;             
        }

        .tab:hover:not(.active) {
            background-color: #ddd;
        }
        .content { display: none; padding: 20px; border: 1px solid #eee; }
        .content.active { display: block; }

        /* 表格與表單樣式 */
        table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
        th, td { border: 1px solid #000; padding: 10px; text-align: left; }
        th { background-color: #f2f2f2; }
        .info-header { display: flex; gap: 20px; margin-bottom: 15px; flex-wrap: wrap; }
        input[type="text"], input[type="date"], textarea { padding: 5px; border: 1px solid #ccc; font-size: 14px; }
        textarea { width: 100%; height: 80px; resize: vertical; }

        /* 按鈕樣式 */
        .btn-print { background-color: #28a745; color: white; padding: 10px 15px; border: none; cursor: pointer; border-radius: 5px; font-weight: bold; }
        .btn-print:hover { background-color: #218838; }
        .print-pos { float: right; margin-bottom: 10px; }

        /* 隱藏區塊 */
        .feedback-group { display: none; margin-top: 10px; }
        .feedback-item { margin-bottom: 5px; display: block; }
        
        /* 給藥途徑選擇區 */
        .route-options { margin-bottom: 15px; padding: 10px; background-color: #eef; border-radius: 5px; }
        .route-options label { margin-right: 15px; cursor: pointer; }

        /* 列印格式優化 */
        @media print {
            .no-print, .tab-container, .btn-print, .print-exclude { display: none !important; }
            body { padding: 0; }
            .content { display: block !important; border: none; }
            #tab1 { display: none !important; } /* 只印評量表 */
            
            /* 只顯示被勾選的質性回饋 */
            .feedback-item { display: none; }
            .feedback-item:has(input:checked) { display: block !important; }
            
            input[type="radio"], input[type="checkbox"] { accent-color: black; }
            .route-options { border: 1px solid #ccc; background-color: white; }
        }
    </style>
</head>
<body>

    <div class="tab-container no-print">
        <button class="tab active" onclick="showTab('tab1')">EPAs-病人給藥-(1)說明</button>
        <button class="tab" onclick="showTab('tab2')">病人給藥-(2)評量表</button>
    </div>

    <div id="tab1" class="content active">
        <h1>台灣護理學會可信賴專業活動 EPAs-病人給藥</h1>
        
        <h3>1. 標題</h3>
        <p>病人給藥</p>

        <h3>2. 任務描述</h3>
        <p>執行給藥作業，包含：<br>
            (1)確認醫囑。<br>
            (2)執行病人辨識及給藥三讀五對。<br>
            (3)給藥前評估（如意識、生命徵象、吞嚥能力等）。<br>
            (4)說明給藥目的、副作用、注意事項。<br>
            (5)紀錄及追蹤。<br>
            <b>限制：</b><br>
            不包含急救、化療、手術及檢查中病人給藥。<br>
            <b>完成訓練必需（不限於）觀察之臨床情境：</b><br>
            口服給藥、肌肉注射給藥、皮下注射給藥、靜脈注射給藥。</p>
        
        <h3>3. 任務失敗時可能造成的風險</h3>
        <p>(1)學員：給藥錯誤，倍感壓力喪失工作信心。<br>
           (2)病人：給藥錯誤造成病人傷害，影響病人生命安全，延長住院天數。<br>
           (3)醫院：病人∕照護者對醫護不信任，產生醫療糾紛，影響醫院聲譽。</p>
        
        <h3>4. 對應之核心能力</h3>
        <table>
            <tr>
                <td>
                    <table style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                        <tr style="background-color: #d9d9d9; text-align: center; font-weight: bold;">
                            <td style="border: 1px solid black; width: 85%; text-align: center; vertical-align: middle; padding: 5px;">ACGME 核心能力</td>
                            <td style="border: 1px solid black; width: 15%; text-align: center; vertical-align: middle; padding: 5px;">核心能力</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">病人照護 Patient Care（PC） </td>
                            <td style="border: 1px solid black; text-align: center;">✓</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">醫學知識 Medical Knowledge（MK） </td>
                            <td style="border: 1px solid black; text-align: center;">✓</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">從工作中學習及成長 Practice-based learning and improvement （PBLI） </td>
                            <td style="border: 1px solid black; text-align: center;"></td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">人際與溝通技巧 Interpersonal & Communication Skills（ICS） </td>
                            <td style="border: 1px solid black; text-align: center;">✓</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">專業素養 Professionalism（PROF） </td>
                            <td style="border: 1px solid black; text-align: center;"></td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">制度下之臨床工作 System-based Practice（SBP） </td>
                            <td style="border: 1px solid black; text-align: center;"></td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

        <h3>5. 先備知識、技能、態度與經驗</h3>
        <table>
            <tr>
                <th style="border: 1px solid black; text-align: center; vertical-align: middle; padding: 10px; background-color: #f2f2f2;">知識</th>
                <th style="border: 1px solid black; text-align: center; vertical-align: middle; padding: 10px; background-color: #f2f2f2;">技能</th>
                <th style="border: 1px solid black; text-align: center; vertical-align: middle; padding: 10px; background-color: #f2f2f2;">態度</th>
                <th style="border: 1px solid black; text-align: center; vertical-align: middle; padding: 10px; background-color: #f2f2f2;">必要經歷</th>
            </tr>
            <tr>
                <td>(1) 藥物作用及機轉。<br>(2) 三讀五對內容。<br>(3) 病人辨識方式。<br>(4) 不同藥物劑型、途徑的注意事項。<br>(5) 須雙重核對、高警訊、管制藥等藥物。<br>(6) 異常問題處理流程。<br>(7) 藥物參考資料及給藥標準文件。</td>
                <td>(1)執行三讀五對內容。<br>(2)執行病人辨識方式。<br>(3)辨識須雙重核對、高警訊、管制藥等藥物。<br>(4)執行異常問題處理流程。<br>(5)運用人際與溝通技巧進行住院病人給藥。</td>
                <td>(1) 尊重病人的隱私。<br>(2) 核對藥物時須謹慎。<br>(3) 親視病人服藥。<br>(4) 關切病人用藥後反應。<br>(5) 提供同理與尊重的應對及說明。</td>
                <td>見習住院病人給藥作業至少 5 次（含）以上。</td>
            </tr>
        </table>

        <h3>6. 評估進展所需相關資訊</h3>
        <p><b>(1)口試：</b>試用期內執行單位常見藥物口試及格。</p>
        <p><b>(2)直接觀察評估：</b>針對學員在某一次（或某一班）任務執行的實際表現進行觀察與評估，推薦的工具有 ad-hoc EPA-based assessment、mini-CEX、DOPS……等，試用期內至少擇一工具完成 3 次。</p>

        <h3>7. 期待學員能夠獨立操作的時機</h3>
        <p>3個月內達Level 4。</p>

        <h3>8. 信賴等級維持期限</h3>
        <p>離開工作單位≧6 個月，信賴授權、應重新評估至少 1 次且達 Level 4。</p>
    </div>

    <div id="tab2" class="content">
        <button class="btn-print print-pos no-print" onclick="handlePrint()">列印/另存PDF</button>
        <h1>台灣護理學會可信賴專業活動 EPAs-住院病人給藥評量表</h1>

        <style>
            .info-table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 20px;
                border: none !important;
            }

            .info-table td {
                padding: 10px 5px;
                border: none !important;
                vertical-align: middle;
            }

            .info-table input[type="text"], 
            .info-table input[type="date"] {
                padding: 5px;
                font-size: 14px;
            }
        </style>

        <table class="info-table">
            <tr>
                <td style="width: 45%;">
                    學員：<input type="text" id="studentName" placeholder="輸入姓名"> 
                </td>
                <td>
                    到職日（西元年∕月∕日）：<input type="date" id="hireDate"> 
                </td>
            </tr>
            <tr>
                <td>
                    教師：<input type="text" id="teacherName" placeholder="輸入姓名"> 
                </td>
                <td>
                    填表日期（西元年∕月∕日）：<input type="date" id="formDate"> 
                </td>
            </tr>
        </table>
        
        <div class="route-options">
            <b>給藥途徑：</b><br>
            <label><input type="radio" name="route"> 口服</label>
            <label><input type="radio" name="route"> 肌肉注射</label>
            <label><input type="radio" name="route"> 皮下注射</label>
            <label><input type="radio" name="route"> 靜脈注射</label>
        </div>

        <h3>1. 主題：病人給藥</h3>

        <h3>2. 情境：</h3>
        <p>在臨床照護中執行病人給藥。</p>
        <p>【使用限制：急救、化療、手術及檢查中病人給藥。】</p>
        
        <h3>3. 信賴等級評量：</h3>
        <p>（觀察學員執行狀況，下次遇到類似情境時，您認為此學員勝任之程度)</p>
        
        <table >
            <tr>
                <th style="text-align: center; vertical-align: middle; width: 15%;">信賴等級</th>
                <td style="text-align: center; vertical-align: middle; width: 17%;">Level 1</td>
                <td style="text-align: center; vertical-align: middle; width: 17%;">Level 2</td>
                <td style="text-align: center; vertical-align: middle; width: 17%;">Level 3</td>
                <td style="text-align: center; vertical-align: middle; width: 17%;">Level 4</td>
                <td style="text-align: center; vertical-align: middle; width: 17%;">Level 5</td>
            </tr>
            <tr>
                <th style="text-align: center; vertical-align: middle;">評量項目</th>
                <td style="text-align: center; vertical-align: middle;">學習者在旁觀察</td>
                <td style="text-align: center; vertical-align: middle;">教師在旁指導，必要時協助</td>
                <td style="text-align: center; vertical-align: middle;">教師後重點確認</td>
                <td style="text-align: center; vertical-align: middle;">可獨立執行</td>
                <td style="text-align: center; vertical-align: middle;">可對其他人進行教學</td>
            </tr>
            <tr>
                <th style="text-align: center; vertical-align: middle;">整體評量</th>
                <td style="text-align: center; vertical-align: middle;"><input type="radio" name="trust_level" value="1"></td>
                <td style="text-align: center; vertical-align: middle;"><input type="radio" name="trust_level" value="2"></td>
                <td style="text-align: center; vertical-align: middle;"><input type="radio" name="trust_level" value="3"></td>
                <td style="text-align: center; vertical-align: middle;"><input type="radio" name="trust_level" value="4"></td>
                <td style="text-align: center; vertical-align: middle;"><input type="radio" name="trust_level" value="5"></td>
            </tr>
        </table>   

        <h3>4. 回饋參考內容</h3>
        <table id="ratingTable">
            <tr>
                <th style="text-align: center; vertical-align: middle;">觀察發現</th>
                <th style="text-align: center; vertical-align: middle;">未觀察</th><th style="text-align: center; vertical-align: middle;">可再加強</th><th style="text-align: center; vertical-align: middle;">符合期待</th><th style="text-align: center; vertical-align: middle;">優於期待</th>
            </tr>
            <tr>
                <td>(1) 確認醫囑</td>
                <td style="text-align: center;"><input type="radio" name="r1" value="bad" onclick="toggleFeedback(1, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r1" value="bad" onclick="toggleFeedback(1, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r1" value="good" onclick="toggleFeedback(1, 'good')"></td>
                <td style="text-align: center;"><input type="radio" name="r1" value="good" onclick="toggleFeedback(1, 'good')"></td>
            </tr>
            <tr>
                <td>(2) 執行病人辨識及給藥三讀五對</td>
                <td style="text-align: center;"><input type="radio" name="r2" value="bad" onclick="toggleFeedback(2, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r2" value="bad" onclick="toggleFeedback(2, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r2" value="good" onclick="toggleFeedback(2, 'good')"></td>
                <td style="text-align: center;"><input type="radio" name="r2" value="good" onclick="toggleFeedback(2, 'good')"></td>
            </tr>
            <tr>
                <td>(3) 給藥前評估</td>
                <td style="text-align: center;"><input type="radio" name="r3" value="bad" onclick="toggleFeedback(3, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r3" value="bad" onclick="toggleFeedback(3, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r3" value="good" onclick="toggleFeedback(3, 'good')"></td>
                <td style="text-align: center;"><input type="radio" name="r3" value="good" onclick="toggleFeedback(3, 'good')"></td>
            </tr>
            <tr>
                <td>(4) 說明給藥目的、副作用、注意事項</td>
                <td style="text-align: center;"><input type="radio" name="r4" value="bad" onclick="toggleFeedback(4, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r4" value="bad" onclick="toggleFeedback(4, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r4" value="good" onclick="toggleFeedback(4, 'good')"></td>
                <td style="text-align: center;"><input type="radio" name="r4" value="good" onclick="toggleFeedback(4, 'good')"></td>
            </tr>
            <tr>
                <td>(5) 紀錄及追蹤</td>
                <td style="text-align: center;"><input type="radio" name="r5" value="bad" onclick="toggleFeedback(5, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r5" value="bad" onclick="toggleFeedback(5, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r5" value="good" onclick="toggleFeedback(5, 'good')"></td>
                <td style="text-align: center;"><input type="radio" name="r5" value="good" onclick="toggleFeedback(5, 'good')"></td>
            </tr>
        </table>

        <h3>5. 學員質性回饋</h3>
        <textarea style="width: 100%; height: 200px; padding: 10px; font-size: 16px;" placeholder="請填寫您的學習心得..."></textarea>

        <h3>6. 護理臨床教師質性回饋</h3>
        
        <div id="commendable-title" style="display:none; font-weight:bold; color:green; margin-top:10px;">值得嘉許：</div>
        
        <div id="good-feedback-1" class="feedback-group">
            <span class="print-exclude"><b>(1) 確認醫囑</b></span>
            <label class="feedback-item"><input type="checkbox"> 你能及時注意到有新的醫囑開立，並正確確認醫囑。</label>
            <label class="feedback-item"><input type="checkbox"> 你在確認醫囑時能說出用藥原因，顯示對病情非常了解。</label>
        </div>
        
        <div id="good-feedback-2" class="feedback-group">
            <span class="print-exclude"><b>(2) 執行病人辨識及給藥三讀五對</b></span>
            <label class="feedback-item"><input type="checkbox"> 能以兩種以上之方法辨識病人，例如：稱呼全名、核對手圈或床頭卡。</label>
            <label class="feedback-item"><input type="checkbox"> 在執行三讀五對時流程清楚且不慌亂。</label>
        </div>

        <div id="good-feedback-3" class="feedback-group">
            <span class="print-exclude"><b>(3) 給藥前評估（如意識、生命徵象、吞嚥能力等）</b></span>
            <label class="feedback-item"><input type="checkbox"> 你能主動評估病人的意識狀態與吞嚥情形，顯示你對病人安全的重視。</label>
            <label class="feedback-item"><input type="checkbox"> 給予降血壓藥物前，除了量測血壓，還能主動詢問病人有無頭暈等不適，顯示出做到給藥前評估。</label>
        </div>
        
        <div id="good-feedback-4" class="feedback-group">
            <span class="print-exclude"><b>(4) 說明給藥目的、副作用、注意事項</b></span>
            <label class="feedback-item"><input type="checkbox"> 能使用病人可以理解的簡單語言說明給藥目的、副作用、注意事項。</label>
            <label class="feedback-item"><input type="checkbox"> 能提醒病人/家屬當出現不適時，需立即告知護理師的警訊，可讓病人感到安心。</label>
        </div>

        <div id="good-feedback-5" class="feedback-group">
            <span class="print-exclude"><b>(5) 紀錄及追蹤</b></span>
            <label class="feedback-item"><input type="checkbox"> 你能主動追蹤病人的特殊用藥(如血糖藥、降壓藥等)反應並即時回報，使照護連續性良好。</label>
            <label class="feedback-item"><input type="checkbox"> 給藥紀錄完整、明確，無遺漏。</label>
        </div>

        <div id="improvement-title" style="display:none; font-weight:bold; color:red; margin-top:10px;">可再精進：</div>
        
        <div id="bad-feedback-1" class="feedback-group">
            <span class="print-exclude"><b>(1) 確認醫囑</b></span>
             </div>
         <div id="bad-feedback-2" class="feedback-group">
            <span class="print-exclude"><b>(2) 執行病人辨識及給藥三讀五對</b></span>
            </div>

        <div id="bad-feedback-3" class="feedback-group">
            <span class="print-exclude"><b>(3) 給藥前評估（如意識、生命徵象、吞嚥能力等）</b></span>
            <label class="feedback-item"><input type="checkbox"> 給藥前評估部分，可以再關心病人是否有任何不適(例如噁心、頭暈等)會更好。</label>
        </div>
        
        <div id="bad-feedback-4" class="feedback-group">
            <span class="print-exclude"><b>(4) 說明給藥目的、副作用、注意事項</b></span>
            <label class="feedback-item"><input type="checkbox"> 可以嘗試用更簡潔易懂的語言向病人說明藥物作用和副作用，並鼓勵病人提出問題。</label>
            <label class="feedback-item"><input type="checkbox"> 可以試著多思考藥物的作用機轉和可能的副作用，並將其應用於臨床照護中。</label>
        </div>

        <div id="bad-feedback-5" class="feedback-group">
            <span class="print-exclude"><b>(5) 紀錄及追蹤</b></span>
            <label class="feedback-item"><input type="checkbox"> 建議詳細記錄給藥後反應，以便後續評估用藥效果。</label>
            <label class="feedback-item"><input type="checkbox"> 建議臨時醫囑給藥後，要追蹤並記錄病人用藥反應。</label>
        </div>

        <br>
        <button class="btn-print no-print" onclick="handlePrint()">列印/另存PDF</button>
    </div>

    <script>
        // 頁籤切換
        function showTab(tabId) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.querySelector(`button[onclick="showTab('${tabId}')"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // 聯動回饋邏輯
        function toggleFeedback(itemNum, type) {
            const goodGroup = document.getElementById(`good-feedback-${itemNum}`);
            const badGroup = document.getElementById(`bad-feedback-${itemNum}`);
            
            if (goodGroup && badGroup) {
                if (type === 'good') {
                    goodGroup.style.display = 'block';
                    badGroup.style.display = 'none';
                    badGroup.querySelectorAll('input').forEach(i => i.checked = false);
                } else {
                    goodGroup.style.display = 'none';
                    badGroup.style.display = 'block';
                    goodGroup.querySelectorAll('input').forEach(i => i.checked = false);
                }
            }

            // 控制大標題顯示
            updateSectionTitles();
        }

        function updateSectionTitles() {
            const anyGood = Array.from(document.querySelectorAll('[id^="good-feedback-"]')).some(el => el.style.display === 'block');
            const anyBad = Array.from(document.querySelectorAll('[id^="bad-feedback-"]')).some(el => el.style.display === 'block');
            
            document.getElementById('commendable-title').style.display = anyGood ? 'block' : 'none';
            document.getElementById('improvement-title').style.display = anyBad ? 'block' : 'none';
        }

        // 列印功能
        function handlePrint() {
            const name = document.getElementById('studentName').value || "未填寫";
            const date = document.getElementById('formDate').value || "未填寫日期";
            const originalTitle = document.title;

            // 設置 PDF 檔名（透過修改網頁 Title）
            document.title = `EPAs-病人給藥-${name}-${date}`;
            
            window.print();
            
            // 還原標題
            document.title = originalTitle;
        }

        // 預設今天日期
        document.getElementById('formDate').valueAsDate = new Date();
    </script>
</body>
</html>