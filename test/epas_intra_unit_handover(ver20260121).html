<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPAs-單位內護理交班</title>
    <style>
        body { font-family: "Microsoft JhengHei", Arial, sans-serif; margin: 0; padding: 20px; line-height: 1.6; }
        
        /* 頁籤樣式 */
        .tab-container { display: flex; background-color: #f1f1f1; border-bottom: 1px solid #ccc; margin-bottom: 20px; }
        .tab { padding: 10px 20px; cursor: pointer; background-color: #f1f1f1; border: none; outline: none; transition: 0.3s; font-size: 16px; }
        .tab:hover { background-color: #ddd; }
        .tab.active { background-color: #fff; font-weight: bold; border-top: 3px solid #0056b3; }
        .content { display: none; padding: 20px; border: 1px solid #eee; }
        .content.active { display: block; }

        /* 表格與表單樣式 */
        table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
        th, td { border: 1px solid #000; padding: 10px; text-align: left; }
        th { background-color: #f2f2f2; }
        .info-header { display: flex; gap: 20px; margin-bottom: 15px; flex-wrap: wrap; }
        input[type="text"], input[type="date"], textarea { padding: 5px; border: 1px solid #ccc; font-size: 14px; }
        textarea { width: 100%; height: 80px; resize: vertical; }

        /* 按鈕樣式 */
        .btn-print { background-color: #28a745; color: white; padding: 10px 15px; border: none; cursor: pointer; border-radius: 5px; font-weight: bold; }
        .btn-print:hover { background-color: #218838; }
        .print-pos { float: right; margin-bottom: 10px; }

        /* 隱藏區塊 */
        .feedback-group { display: none; margin-top: 10px; }
        .feedback-item { margin-bottom: 5px; display: block; }

        /* 列印格式優化 */
        @media print {
            .no-print, .tab-container, .btn-print, .print-exclude { display: none !important; }
            body { padding: 0; }
            .content { display: block !important; border: none; }
            #tab1 { display: none !important; } /* 只印評量表 */
            
            /* 只顯示被勾選的質性回饋 */
            .feedback-item { display: none; }
            .feedback-item:has(input:checked) { display: block !important; }
            
            input[type="radio"], input[type="checkbox"] { accent-color: black; }
        }
    </style>
</head>
<body>

    <div class="tab-container no-print">
        <button class="tab active" onclick="showTab('tab1')">EPAs-單位內護理交班說明</button>
        <button class="tab" onclick="showTab('tab2')">單位內護理交班評量表</button>
    </div>

    <div id="tab1" class="content active">
        <h1>台灣護理學會可信賴專業活動 EPAs-單位內護理交班</h1>
        
        <h3>1. 標題</h3>
        <p>單位內護理交班</p>

        <h3>2. 任務描述</h3>
        <p>能將自己照護的病人，交班給下一個班的護理人員。包含：<br>
                    (1)病人資料的統整。<br>
                    (2)依據交接班原則進行交班。<br>
                    (3)對接班者的提問進行確認與釐清。<br>
                    (4)完成護理交班作業規範。<br>
                    <b>限制：</b><br>
                    排除單位間交班（例如：手術、檢查、轉加護病房等）及跨領域交班（例如：醫事職類交班等）。<br>
                    <b>完成訓練必需（不限於）觀察之臨床情境：</b>單位內護理交班。</p>
        
        <h3>3. 任務失敗時可能造成的風險</h3>
        <p>(1)學員：交班內容不完整或接班者詢問時無法回應，而倍感壓力喪失工作信心；不必要的交班內容造成交班時間冗長，影響下一班照護時間及延遲下班。<br>
                    (2)病人：交班訊息錯誤或不完整，導致處置錯誤或延誤，影響病人照護連續性及病人安全。<br>
                    (3)醫院：病人∕照護者對醫護不信任，產生醫療糾紛，影響醫院聲譽。</p>
        
        <h3>4. 對應之核心能力</h3>
        <table>
            <tr>
                
                <td>
                    <table style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                        <tr style="background-color: #d9d9d9; text-align: center; font-weight: bold;">
                            <td style="border: 1px solid black; width: 85%; text-align: center; vertical-align: middle; padding: 5px;">ACGME 核心能力</td>
                            <td style="border: 1px solid black; width: 15%; text-align: center; vertical-align: middle; padding: 5px;">核心能力</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">病人照護 Patient Care（PC） </td>
                            <td style="border: 1px solid black; text-align: center;"></td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">醫學知識 Medical Knowledge（MK） </td>
                            <td style="border: 1px solid black; text-align: center;">✓</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">從工作中學習及成長 Practice-based learning and improvement （PBLI） </td>
                            <td style="border: 1px solid black; text-align: center;"></td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">人際與溝通技巧 Interpersonal & Communication Skills（ICS） </td>
                            <td style="border: 1px solid black; text-align: center;">✓</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">專業素養 Professionalism（PROF） </td>
                            <td style="border: 1px solid black; text-align: center;">✓</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black; padding: 5px;">制度下之臨床工作 System-based Practice（SBP） </td>
                            <td style="border: 1px solid black; text-align: center;">✓</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

        <h3>5. 先備知識、技能、態度與經驗</h3>
        <table>
            <tr>
                <th style="border: 1px solid black; text-align: center; vertical-align: middle; padding: 10px; background-color: #f2f2f2;">知識</th>
                <th style="border: 1px solid black; text-align: center; vertical-align: middle; padding: 10px; background-color: #f2f2f2;">技能</th>
                <th style="border: 1px solid black; text-align: center; vertical-align: middle; padding: 10px; background-color: #f2f2f2;">態度</th>
                <th style="border: 1px solid black; text-align: center; vertical-align: middle; padding: 10px; background-color: #f2f2f2;">必要經歷</th>
            </tr>
            <tr>
                <td>(1) 單位內交班工作指導書。<br>(2) 單位相關疾病照護知識。<br>(3)管路安全工作指導書。</td>
                <td>(1)操作相關資訊系統。<br>(2)執行ISBAR 交班。<br>(3)運用護理資訊系統操作來執行病人交班。</td>
                <td>(1) 表現出用心且具責任感的交班態度。<br>(2)尊重病人的隱私。<br>(3)展現交班作業的自信。<br>(4)願意接受同儕或教師回饋。</td>
                <td>全程見習病人交班至少10次（含）以上。</td>
            </tr>
        </table>

        <h3>6. 評估進展所需相關資訊</h3>
        <p>直接觀察評估：針對學員在某一次（或某一班）任務執行的實際表現進行觀察與評估，推薦的工具有 ad-hoc EPA-based assessment、mini-CEX、DOPS……等，試用期內至少擇一工具完成 3 次。</p>

        <h3>7. 期待學員能夠獨立操作的時機</h3>
        <p>3個月內達Level 4。</p>

        <h3>8. 信賴等級維持期限</h3>
        <p>離開工作單位≧6 個月，信賴授權、應重新評估至少 1 次且達 Level 4。</p>
    </div>

    <div id="tab2" class="content">
        <button class="btn-print print-pos no-print" onclick="handlePrint()">列印/另存PDF</button>
        <h1>台灣護理學會可信賴專業活動 EPAs-單位內護理交班評量表</h1>

        <!--  
        <div class="info-header">
            <div>學員：<input type="text" id="studentName" placeholder="輸入姓名"></div>
            <div>到職日：<input type="date" id="hireDate"></div>
            <div>教師：<input type="text" id="teacherName" placeholder="輸入姓名"></div>
            <div>填表日期：<input type="date" id="formDate"></div>
        </div>
        -->
        
        <style>
            /* 僅針對排版用的表格，去除所有框線並設定間距 */
            .info-table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 20px;
                border: none !important; /* 確保外框消失 */
            }

            .info-table td {
                padding: 10px 5px;
                border: none !important; /* 確保儲存格沒有線 */
                vertical-align: middle;
            }

            .info-table input[type="text"], 
            .info-table input[type="date"] {
                padding: 5px;
                font-size: 14px;
            }
        </style>

        <table class="info-table">
            <tr>
                <td style="width: 45%;">
                    學員：<input type="text" id="studentName" placeholder="輸入姓名"> 
                </td>
                <td>
                    到職日（西元年∕月∕日）：<input type="date" id="hireDate"> 
                </td>
            </tr>
            <tr>
                <td>
                    教師：<input type="text" id="teacherName" placeholder="輸入姓名"> 
                </td>
                <td>
                    填表日期（西元年∕月∕日）：<input type="date" id="formDate"> 
                </td>
            </tr>
        </table>

        <h3>1. 主題：單位內護理交班</h3>

        <h3>2. 情境：</h3>
        <p>能將自己照護的病人，交班給下一個班的護理人員。</p>
        <p>【使用限制：排除單位間交班（例如：手術、檢查、轉加護病房等）及跨領域交班（例如：醫事職類交班等）。】</p>

        <h3>3. 信賴等級評量：</h3>
        <p>（觀察學員執行狀況，下次遇到類似情境時，你認為此學員勝任之程度)</p>
        
        <!-- <table> 
            <tr>
                <th>Level 1</th><th>Level 2</th><th>Level 3</th><th>Level 4</th><th>Level 5</th>
            </tr>
            <tr>
                <td>在旁觀察</td><td>教師指導助</td><td>事後重點確認</td><td>可獨立執行</td><td>可教學</td>
            </tr>
            <tr>
                <td><input type="radio" name="level" value="1"></td>
                <td><input type="radio" name="level" value="2"></td>
                <td><input type="radio" name="level" value="3"></td>
                <td><input type="radio" name="level" value="4"></td>
                <td><input type="radio" name="level" value="5"></td>
            </tr>
        </table>-->
        <table >
            <tr>
                <th style="text-align: center; vertical-align: middle; width: 15%;">信賴等級</th>
                <td style="text-align: center; vertical-align: middle; width: 17%;">Level 1</td>
                <td style="text-align: center; vertical-align: middle; width: 17%;">Level 2</td>
                <td style="text-align: center; vertical-align: middle; width: 17%;">Level 3</td>
                <td style="text-align: center; vertical-align: middle; width: 17%;">Level 4</td>
                <td style="text-align: center; vertical-align: middle; width: 17%;">Level 5</td>
            </tr>
            <tr>
                <th style="text-align: center; vertical-align: middle;">評量項目</th>
                <td style="text-align: center; vertical-align: middle;">學習者在旁觀察</td>
                <td style="text-align: center; vertical-align: middle;">教師在旁指導，必要時協助</td>
                <td style="text-align: center; vertical-align: middle;">教師事後重點確認</td>
                <td style="text-align: center; vertical-align: middle;">可獨立執行</td>
                <td style="text-align: center; vertical-align: middle;">可對其他人進行教學</td>
            </tr>
            <tr>
                <th style="text-align: center; vertical-align: middle;">整體評量</th>
                <td style="text-align: center; vertical-align: middle;"><input type="radio" name="trust_level" value="1"></td>
                <td style="text-align: center; vertical-align: middle;"><input type="radio" name="trust_level" value="2"></td>
                <td style="text-align: center; vertical-align: middle;"><input type="radio" name="trust_level" value="3"></td>
                <td style="text-align: center; vertical-align: middle;"><input type="radio" name="trust_level" value="4"></td>
                <td style="text-align: center; vertical-align: middle;"><input type="radio" name="trust_level" value="5"></td>
            </tr>
        </table>   

        <h3>4. 回饋參考內容</h3>
        <table id="ratingTable">
            <tr>
                <th style="text-align: center; vertical-align: middle;">觀察發現</th>
                <th style="text-align: center; vertical-align: middle;">未觀察</th><th style="text-align: center; vertical-align: middle;">可再加強</th><th style="text-align: center; vertical-align: middle;">符合期待</th><th style="text-align: center; vertical-align: middle;">優於期待</th>
            </tr>
            <tr>
                <td>(1) 病人資料的統整</td>
                <td style="text-align: center;"><input type="radio" name="r1" value="bad" onclick="toggleFeedback(1, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r1" value="bad" onclick="toggleFeedback(1, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r1" value="good" onclick="toggleFeedback(1, 'good')"></td>
                <td style="text-align: center;"><input type="radio" name="r1" value="good" onclick="toggleFeedback(1, 'good')"></td>
            </tr>
            <tr>
                <td>(2) 依據交接班原則進行交班</td>
                <td style="text-align: center;"><input type="radio" name="r2" value="bad" onclick="toggleFeedback(2, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r2" value="bad" onclick="toggleFeedback(2, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r2" value="good" onclick="toggleFeedback(2, 'good')"></td>
                <td style="text-align: center;"><input type="radio" name="r2" value="good" onclick="toggleFeedback(2, 'good')"></td>
            </tr>
            <tr>
                <td>(3) 對接班者的提問釐清</td>
                <td style="text-align: center;"><input type="radio" name="r3" value="bad" onclick="toggleFeedback(3, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r3" value="bad" onclick="toggleFeedback(3, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r3" value="good" onclick="toggleFeedback(3, 'good')"></td>
                <td style="text-align: center;"><input type="radio" name="r3" value="good" onclick="toggleFeedback(3, 'good')"></td>
            </tr>
            <tr>
                <td>(4) 完成護理交班作業規範</td>
                <td style="text-align: center;"><input type="radio" name="r4" value="bad" onclick="toggleFeedback(4, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r4" value="bad" onclick="toggleFeedback(4, 'bad')"></td>
                <td style="text-align: center;"><input type="radio" name="r4" value="good" onclick="toggleFeedback(4, 'good')"></td>
                <td style="text-align: center;"><input type="radio" name="r4" value="good" onclick="toggleFeedback(4, 'good')"></td>
            </tr>
        </table>

        <h3>3. 學員質性回饋</h3>
        <textarea style="width: 100%; height: 200px; padding: 10px; font-size: 16px;" placeholder="請填寫您的學習心得..."></textarea>

        <h3>4. 護理臨床教師質性回饋</h3>
        
        <div id="commendable-title" style="display:none; font-weight:bold; color:green; margin-top:10px;">值得嘉許：</div>
        
        <div id="good-feedback-1" class="feedback-group">
            <span class="print-exclude">(1) 病人資料的統整</span>
            <label class="feedback-item"><input type="checkbox"> 你在交班前已完整查閱護理資訊系統，並有條理地歸納出交班留言的重點，顯示出極佳的資訊整合能力。</label>
            <label class="feedback-item"><input type="checkbox"> 你在交接班前能主動查詢報告及檢查回覆，展現出你對病人狀況的掌握。</label>
            <label class="feedback-item"><input type="checkbox"> 我注意到你能積極查詢病人的檢驗值及報告及相關照護資訊，不斷精進自己的專業知識和技能。</label>
            <label class="feedback-item"><input type="checkbox"> 你對所照護的病人資訊掌握完整，交班時能簡明扼要說出交班重點，有助於接班者快速掌握照護重點。</label>
            <label class="feedback-item"><input type="checkbox"> 你能清晰且不遺漏地統整每位病人的重要資訊，展現出專業的態度。</label>
        </div>
        <div id="good-feedback-2" class="feedback-group">
            <span class="print-exclude">(2) 依據交接班原則進行交班</span>
            <label class="feedback-item"><input type="checkbox"> 你能夠熟練地按照ISBAR的順序完成交班作業，展現出你對交班作業的瞭解。</label>
            <label class="feedback-item"><input type="checkbox"> 你對病人現況(Situation)的描述，不僅包含生命徵象，還主動納入重要的護理問題和身上管路狀態，體現了照護的完整性。</label>
            <label class="feedback-item"><input type="checkbox"> 你在交班過程中能夠詳細介紹病人的基本資料、現況、過去狀況、重要評估與提醒建議，這對於接班者非常有幫助。</label>
            <label class="feedback-item"><input type="checkbox"> 在Assessment部分，你能準確提出最近的檢驗結果與重要傷口變化，使交班內容具有極高的時效性和臨床價值</label>
            <label class="feedback-item"><input type="checkbox"> 你能完成交班資料的完成整性，如檢驗、檢查、會診，報告結果及異常等處理，讓接班者可掌控完整訊息。</label>
        </div>
        <div id="good-feedback-3" class="feedback-group">
            <span class="print-exclude">(3) 對接班者的提問進行確認與釐清。</span>
            <label class="feedback-item"><input type="checkbox"> 我觀察到你能發現病人問題，主動提出討論，透過良好的溝通，釐清交班內容。</label>
            <label class="feedback-item"><input type="checkbox"> 面對接班者的提問，你能即時且準確地回覆，並積極澄清疑慮，確保了資訊在轉移過程中的一致性與正確性。</label>
            <label class="feedback-item"><input type="checkbox"> 在被提問或指正時，你能虛心聆聽並快速修正交班中的小疏漏，這展現了你作為新進人員快速成長的潛力。</label>
            <label class="feedback-item"><input type="checkbox"> 在面對接班者的提問時，你能保持鎮定與專業的溝通態度，清晰地解釋病人現況，沒有因緊張而遺漏或混淆重要資訊。</label>
            <label class="feedback-item"><input type="checkbox"> 對於接班者提出的疑問，你能準確抓到提問的核心焦點，並針對該點進行重點式的澄清，如某床病人的藥物為何做調整，以及目前要觀察的重點。</label>
        </div>
        <div id="good-feedback-4" class="feedback-group">
            <span class="print-exclude">(4) 完成護理交班作業規範</span>
            <label class="feedback-item"><input type="checkbox"> 在口頭交班畢後，你能主動且迅速地共同進入病室，與接班者一同完成床邊檢視，嚴格遵守交班規範。</label>
            <label class="feedback-item"><input type="checkbox"> 在床邊，你能與接班者共同細心檢視病人意識狀態、身上管路、皮膚肢體狀況等關鍵安全項目，充分落實交班 SOP 的最後環節。</label>
            <label class="feedback-item"><input type="checkbox"> 你能準確地與接班者共同檢視並確認所有床旁機器設定（如點滴幫浦流速、監測儀設定等），顯現對病人安全有高度重視。</label>
            <label class="feedback-item"><input type="checkbox"> 你能主動指引接班者觀察傷口或皮膚肢體水腫的變化，並能準確描述與前一班的差異，這代表你已掌握了重點變化觀察的技能。</label>
            <label class="feedback-item"><input type="checkbox"> 你能主動提醒接班者向病人進行自我介紹，並在檢視過程中與接班者保持有效的溝通與互動，顯示出良好的團隊合作意識。</label>
        </div>

        <div id="improvement-title" style="display:none; font-weight:bold; color:red; margin-top:10px;">可再精進：</div>

        <div id="bad-feedback-1" class="feedback-group">
            <span class="print-exclude">(1) 病人資料的統整</span>
            <label class="feedback-item"><input type="checkbox"> 建議在交班前10分鐘，可以先查閱統整病人資料，讓交班準備更快速。</label>
            <label class="feedback-item"><input type="checkbox"> 針對住院時間較久病人，建議聚焦近3天病情變化或主要護理問題，避免過多不影響現況的細節描述。</label>
            <label class="feedback-item"><input type="checkbox"> 建議您下次在整理檢驗/檢查結果時，可以優先將異常值與對應的臨床處理放在最前面，練習將數據與病人的現況連結。</label>
            <label class="feedback-item"><input type="checkbox"> 針對病人在班內的特殊變化，如臨時給藥、檢驗檢查等，建議隨手做筆記，或藉由NIS系統內相關資訊帶入交班留言提醒，避免遺漏資訊或資訊不完。</label>
        </div>
        <div id="bad-feedback-2" class="feedback-group">
            <span class="print-exclude">(2) 依據交接班原則進行交班</span>
            <label class="feedback-item"><input type="checkbox"> 交班內容是尚完整，但建議您可以再熟悉NIS系統-交班留言內各選項，讓資訊傳遞更順暢，避免停頓或跳躍。</label>
            <label class="feedback-item"><input type="checkbox"> 在Assessment 中，建議您不只列出最近檢驗/檢查結果，還要理解臨床意義與處置緣由，如病人尿路感染的症狀，相關指標及為何醫師要調整抗生素。</label>
            <label class="feedback-item"><input type="checkbox"> 在交班時，您的語速可以再放慢一點點，確保接班者有充足的時間理解和記錄關鍵資訊。</label>
            <label class="feedback-item"><input type="checkbox"> 描述護理行動時，請更清楚地區分「已完成的處置」與「仍待執行的醫囑」，確保接班者不會重複或遺漏工作。</label>
        </div>
        <div id="bad-feedback-3" class="feedback-group">
            <span class="print-exclude">(3) 對接班者的提問釐清</span>
            <label class="feedback-item"><input type="checkbox"> 避免模糊或猜測性回答：如「我不太確定」、「好像有」等模糊詞彙，應向接班者誠實回應，事後進行確認再回報。</label>
            <label class="feedback-item"><input type="checkbox"> 當被追問時，可先重複一次提問，避免答非所問，如：「您是問 X 症狀是否與 Y 藥物有關嗎？」這樣能確認自己是否理解問題，若當下不清楚建議與專師/醫師再確認。</label>
            <label class="feedback-item"><input type="checkbox"> 當接班者詢問前一班的特殊處理時，您可以立即參考交班留言區訊息進行釐清。</label>
            <label class="feedback-item"><input type="checkbox"> 交接班有任何疑問，需即時主動提出討論及釐清，以確保資訊無誤。</label>
        </div>
        <div id="bad-feedback-4" class="feedback-group">
            <span class="print-exclude">(4) 完成護理交班作業規範</span>
            <label class="feedback-item"><input type="checkbox"> 你已完成大部分交班資料，建議最後共同進入病室，落實一併檢視病人身上管路、皮膚狀況..等。</label>
            <label class="feedback-item"><input type="checkbox"> 可以試著多練習交班內容的表達，調整交班內容簡潔性，確保訊息正確傳達，並避免交班內容過於冗長。</label>
            <label class="feedback-item"><input type="checkbox"> 每次執行單位內交班流程後，可以花些時間自我反思，思考還有哪些地方可以做得更好。</label>
            <label class="feedback-item"><input type="checkbox"> 建議進一步了解病人的檢驗值及相關照護資訊報告，以精進自己的專業知識和技能。</label>
        </div>

        <br>
        <button class="btn-print no-print" onclick="handlePrint()">列印/另存PDF</button>
    </div>

    <script>
        // 頁籤切換
        function showTab(tabId) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.querySelector(`button[onclick="showTab('${tabId}')"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // 聯動回饋邏輯
        function toggleFeedback(itemNum, type) {
            const goodGroup = document.getElementById(`good-feedback-${itemNum}`);
            const badGroup = document.getElementById(`bad-feedback-${itemNum}`);
            
            if (type === 'good') {
                goodGroup.style.display = 'block';
                badGroup.style.display = 'none';
                // 取消另一組的勾選
                badGroup.querySelectorAll('input').forEach(i => i.checked = false);
            } else {
                goodGroup.style.display = 'none';
                badGroup.style.display = 'block';
                // 取消另一組的勾選
                goodGroup.querySelectorAll('input').forEach(i => i.checked = false);
            }

            // 控制大標題顯示
            updateSectionTitles();
        }

        function updateSectionTitles() {
            const anyGood = Array.from(document.querySelectorAll('[id^="good-feedback-"]')).some(el => el.style.display === 'block');
            const anyBad = Array.from(document.querySelectorAll('[id^="bad-feedback-"]')).some(el => el.style.display === 'block');
            
            document.getElementById('commendable-title').style.display = anyGood ? 'block' : 'none';
            document.getElementById('improvement-title').style.display = anyBad ? 'block' : 'none';
        }

        // 列印功能
        function handlePrint() {
            const name = document.getElementById('studentName').value || "未填寫";
            const date = document.getElementById('formDate').value || "未填寫日期";
            const originalTitle = document.title;

            // 設置 PDF 檔名（透過修改網頁 Title）
            document.title = `EPAs-單位內護理交班-${name}-${date}`;
            
            window.print();
            
            // 還原標題
            document.title = originalTitle;
        }

        // 預設今天日期
        document.getElementById('formDate').valueAsDate = new Date();
    </script>
</body>
</html>